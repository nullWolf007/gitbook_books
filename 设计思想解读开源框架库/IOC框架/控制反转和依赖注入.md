[TOC]

# 控制反转和依赖注入

#### 转载

* [简单解释什么是 依赖注入 和 控制反转](https://juejin.cn/post/6844903486748901383)
* [控制反转和依赖注入的理解(通俗易懂)](https://blog.csdn.net/sinat_21843047/article/details/80297951)

## 一、IOC控制反转

### 1.概述

* **IOC—Inversion of Control，即“控制反转”，不是什么技术，而是一种设计思想。**
* 在Java开发中，**Ioc意味着将你设计好的对象交给容器控制，而不是传统的在你的对象内部直接控制。**

### 2.如何理解好IOC？

* 理解好Ioc的关键是要明确“谁控制谁，控制什么，为何是反转（有反转就应该有正转了），哪些方面反转了”
* 那我们来深入分析一下：

#### 2.1 谁控制谁，控制什么？反转？

##### 传统

* 传统Java SE程序设计，我们直接在对象内部通过new进行创建对象，是程序主动去创建依赖对象；

* 传统应用程序是由我们自己在对象中主动控制去直接获取依赖对象，也就是正转。

* 传统示例

  ```java
  public class Car {
      public void run() {
          System.out.println("跑的飞起来");
      }
  }
  
  public class Person {
      public static void main(String[] args) {
          Car car = new Car();
          car.run();
      }
  }
  
  跑的飞起来
  ```

* 缺点：高耦合，难于测试

##### IOC

* 而IoC是有专门一个容器来创建这些对象，即由Ioc容器来控制对 象的创建；**谁控制谁？当然是IoC 容器控制了对象；控制什么？那就是主要控制了外部资源获取（不只是对象包括比如文件等）**。
* 反转则是由容器来帮忙创建及注入依赖对象；为何是反转？**因为由容器帮我们查找及注入依赖对象，对象只是被动的接受依赖对象，所以是反转；哪些方面反转了？依赖对象的获取被反转了。**

### 3.IOC的优点

* 提高开发效率
* 减少代码量
* 低耦合，易于维护
* 方便测试

## 二、DI依赖注入

### 1.概述

* **DI—Dependency Injection，即“依赖注入”**：**由容器动态的将某个依赖关系注入到对象之中**。

* **IoC和DI**由什么**关系**呢？其实它们**是同一个概念的不同角度描述**，由于控制反转概念比较含糊，所以2004年大师级人物Martin Fowler又给出了一个新的名字：“依赖注入”，所谓依赖注入，就是有IOC容器在运行期间，动态的将某个依赖关系注入到对象之中。

### 2.总结

* 所以，依赖注入DI和控制反转IOC式从不同的角度描述的同一件事情，就是指通过引入IOC容器，利用依赖关系注入的方式，实现对象之间的解耦。

## 三、通俗理解

* 关于 `依赖注入` 与 `控制反转` 的概念有些人觉得很难理解，最近在给别人讲这个概念的时候梳理了一个比较好理解的解释，而且我认为非技术人员也应该能听的懂，因此分享给大家，希望下次你在给别人讲的时候也能讲的明白。

* 其实 `依赖注入` 和 `控制反转` 说的是同一件事情，只是站的角度不同而已。

* 我们就拿超人和小怪兽的事情来做类比对象。

* 地球受到了威胁，不断有小怪兽来想要破坏地球，每来一个小怪兽我们就需要找一个超人去对付他，一个超人肯定是不够的，因为每次来到小怪兽都是不一样的，他们所具有的能力也是不一样的。

* 因此我们必须找到合适的超人去对付他，最坏的情况是每来一个小怪兽我们就要找一个或者制造一个新超人，那么来十个小怪兽，我们就要制造十个，来百个就要制造百个，来千，来万，来亿我们就要制造相应的超人，而大部分超人只能用一次。

* 为了解决这个问题我们引入依赖注入和控制反转的概念，我们将超人和超能力分开，独立的超人和独立的超能力，当一个小怪兽来的时候我们找到超人，将相应的超能力给予他，让他去消灭小怪兽。

* 这样的话我们只需要几个超人就好了，我们不再需要制造超人，而是研究如何制造更多更好的超能力给超人使用。

* 超能力和超人不再是强依赖关系。超能力是由外部给予超人的，超人和超能力有依赖，但是这个依赖是外部给予，因此我们可以说超能力是由外部注入给他的，所以这就叫 `依赖注入`。

* 而反过来说，超人具有何种超能力不是他内部自身控制的，而是由外部控制的，相当于将超能力具有何种功效交给了外部，外部来决定超人该有的超能力，所以超能力的控制权被由自身控制反转为外部控制，这被称为 `控制反转`。

* 这就是关于 `依赖注入` 和 `控制反转` 的我的比较好理解的解释。它能较好的解决对象与对象之间的强耦合问题，同时也能做的按需使用按需加载。

